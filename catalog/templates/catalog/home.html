<!DOCTYPE html>
<html>
<head>
    <title>Каталог голосований</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{% url 'home' %}">Каталог голосований</a>

            <ul class="navbar-nav ms-auto">
                {% if user.is_authenticated %}
                    <li class="nav-item">
                        <span class="navbar-text me-3">User: {{ user.get_username }}</span>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'profile' %}">Профиль</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'create_question' %}">Создать вопрос</a>
                    </li>
                    <li class="nav-item">
                        <form id="logout-form" method="post" action="{% url 'logout' %}" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-link nav-link" style="border: none; background: none; color: rgba(255,255,255,.55);">
                                Выйти
                            </button>
                        </form>
                    </li>
                {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'login' %}">Войти</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'register' %}">Регистрация</a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </nav>

    <div class="container mt-4">
        <h1>Каталог голосований</h1>

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        {% if user.is_authenticated %}
            <a href="{% url 'create_question' %}" class="btn btn-primary mb-3">Создать новый вопрос</a>
        {% else %}
            <div class="alert alert-info">
                <a href="{% url 'login' %}">Войдите</a> или <a href="{% url 'register' %}">зарегистрируйтесь</a>, чтобы создавать вопросы и голосовать.
            </div>
        {% endif %}

        <!-- Список вопросов -->
        {% for question in questions %}
            <div class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title">{{ question.title }}</h5>
                    <p class="card-text">{{ question.short_description }}</p>

                    <p class="text-muted mt-2">
                        Создано: {{ question.created_at|date:"d.m.Y H:i" }} |
                        Истекает: {{ question.expires_at|date:"d.m.Y H:i" }} |
                        Автор: {{ question.created_by.username }} |
                        Голосов: {{ question.votes_count }}
                    </p>

                    <div class="mt-3">
                        <a href="{% url 'question_detail' question.pk %}" class="btn btn-outline-primary">
                            Подробнее и голосование
                        </a>
                        {% if question.is_expired %}
                            <span class="badge bg-warning text-dark ms-2">Истекло</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% empty %}
            <div class="alert alert-warning">
                Пока нет активных голосований.
                {% if user.is_authenticated %}
                    <a href="{% url 'create_question' %}" class="alert-link">Создайте первый вопрос!</a>
                {% endif %}
            </div>
        {% endfor %}
    </div>
</body>
</html> #